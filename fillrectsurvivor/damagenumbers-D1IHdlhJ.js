(function(){let e=[[0,0,0],[0,255,255],[255,0,255],[255,255,0],[255,0,0],[0,255,0],[0,0,255]];var t=class{bmp;promise;constructor(e){this.promise=fetch(`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAYAAABSIVz6AAAAdElEQVR4AZTOQQ4DIQxD0Xbuf+eWF9WSFU0XgzB2fhDk+tR6/Vah2+jabeMBvDzyPou3DpqNTTiHvHXwbHxCHRhBnJLnY2Arw+OdU3PqXme9CN/578cumq7VbOfUfMsbGCd5Pu6JwAhvhcfT6zq53T01J/kLAAD//8R2uWMAAAAGSURBVAMAGC7Dq7DPgRkAAAAASUVORK5CYII=`).then(t=>t.blob().then(t=>createImageBitmap(t).then(t=>{if(e){let n=t.width,r=t.height,i=new OffscreenCanvas(n,r).getContext(`2d`);i.drawImage(t,0,0);let a=i.getImageData(0,0,n,r),o=a.data;for(let t=0;t<o.length;t+=4)for(let n=0;n<3;n++)o[t+n]-=e[n];return createImageBitmap(a).then(e=>this.bmp=e)}else return this.bmp=t})))}draw(e,t,n,r){let i=t.toString().split(``).map(Number);e.fillRect(n,r,4*i.length+1,7);for(let t=0;t<i.length;t++)e.drawImage(this.bmp,3*i[t],0,3,5,n+4*t+1,r+1,3,5)}};let n,r,i,a=e.map(e=>new t(e)),o,s=!1;onmessage=e=>{let t=e.data;if(t.type===`init`){r=new OffscreenCanvas(t.w,t.h),i=r.getContext(`2d`,{willReadFrequently:!0}),n=t.worker_id,Promise.all(a.map(e=>e.promise)).then(e=>{s=!0;let t={type:`ready`,worker_id:n};postMessage(t)});return}if(t.type===`render`){if(!s)return;let{w:e,h:c}={w:r.width,h:r.height},{frame_id:l,pos:u,dmg:d,color:f}=t;o!==void 0&&l-o;let p=i.getImageData(0,0,e,c),m=p.data;for(let e=3;e<m.length;e+=4)m[e]-=Math.sqrt(256-m[e]);i.putImageData(p,0,0);for(let e=0;e<u.length;e++)a[f[e]].draw(i,d[e],Math.floor(u[e].x),Math.floor(u[e].y));createImageBitmap(r).then(e=>{let t={type:`bmp`,frame_id:l,worker_id:n,bmp:e};postMessage(t,{transfer:[e]})}),o=l;return}}})();